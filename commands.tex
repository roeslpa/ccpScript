%!TEX root=main.tex

\let\oldparagraph=\paragraph
\renewcommand\paragraph[1]{\oldparagraph{#1.}}

\newcolumntype{C}[1]{>{\centering\arraybackslash\hspace{0pt}}p{#1}}

\newcommand{\algbox}[2]{\fbox{\parbox{#1}{#2}}}
\newcommand{\arrbox}[2]{\parbox{#1}{\centering#2}}

\newcommand{\getsr}{\gets_\$}
\newcommand{\tor}{\to_\$}
\newcommand{\es}{\epsilon}
\newcommand{\T}{\mathtt{tru}}
\newcommand{\F}{\mathtt{fal}}
\newcommand{\secp}{\kappa}

\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\BB}{\{0,1\}}
\newcommand{\Bool}{\{\T,\F\}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\PS}{\mathcal{P}}

\newcommand{\advA}{\mathcal{A}}
\newcommand{\advB}{\mathcal{B}}
\newcommand{\advC}{\mathcal{C}}
\newcommand{\advD}{\mathcal{D}}
\newcommand{\Adv}{\mathrm{Adv}}

\newcommand{\APKE}{\mathrm{APKE}}
\renewcommand{\AE}{\mathrm{AE}}
\newcommand{\IKE}{\mathrm{IKE}}


%VARIABLES
\newcommand{\sk}{\mathit{sk}}
\newcommand{\st}{\mathit{st}}
\newcommand{\vk}{\mathit{vk}}
\newcommand{\pk}{\mathit{pk}}
\newcommand{\ek}{\mathit{ek}}
\newcommand{\dk}{\mathit{dk}}
\newcommand{\mtag}{\tau}
\newcommand{\sig}{\sigma}
\newcommand{\ad}{\mathit{ad}}

%SPACES
\newcommand{\sksp}{\mathcal{SK}}
\newcommand{\pksp}{\mathcal{PK}}
\newcommand{\vksp}{\mathcal{VK}}
\newcommand{\eksp}{\mathcal{EK}}
\newcommand{\dksp}{\mathcal{DK}}
\newcommand{\stsp}{\mathcal{ST}}
\newcommand{\ksp}{\mathcal{K}}
\newcommand{\rsp}{\mathcal{R}}
\newcommand{\msp}{\mathcal{M}}
\newcommand{\csp}{\mathcal{C}}
\newcommand{\tsp}{\mathcal{T}}
\newcommand{\sigsp}{\Sigma}
\newcommand{\adsp}{\mathcal{AD}}
\newcommand{\idsp}{\mathcal{ID}}

%ORACLES
\newcommand{\ROh}{\mathrm{H}}

\newcommand{\CORR}{\mathrm{CORR}}
\newcommand{\IND}{{\mathrm{IND}}}
\newcommand{\ind}{{\mathrm{ind}}}
\newcommand{\INDD}{{\mathrm{IND}\$}}
\newcommand{\indd}{{\mathrm{ind}\$}}
\newcommand{\INDCCA}{{\mathrm{IND}\text{-}\mathrm{CCA}}}
\newcommand{\indcca}{{\mathrm{ind}\text{-}\mathrm{cca}}}
\newcommand{\INDCPA}{{\mathrm{IND}\text{-}\mathrm{CPA}}}
\newcommand{\indcpa}{{\mathrm{ind}\text{-}\mathrm{cpa}}}
\newcommand{\OWCCA}{{\mathrm{OW}\text{-}\mathrm{CCA}}}
\newcommand{\owcca}{{\mathrm{ow}\text{-}\mathrm{cca}}}
\newcommand{\SUFCMA}{{\mathrm{SUF}\text{-}\mathrm{CMA}}}
\newcommand{\sufcma}{{\mathrm{suf}\text{-}\mathrm{cma}}}
\newcommand{\ANON}{\mathrm{ANON}}

\newcommand{\Ogen}{\mathrm{Gen}}
\newcommand{\Oinit}{\mathrm{Init}}
\newcommand{\Oenc}{\mathrm{Enc}}
\newcommand{\Odec}{\mathrm{Dec}}
\newcommand{\Oup}{\mathrm{Up}}
\newcommand{\Otag}{\mathrm{Tag}}
\newcommand{\Osig}{\mathrm{Sign}}
\newcommand{\Ovfy}{\mathrm{Vfy}}

\newcommand{\Osnd}{\mathrm{Snd}}
\newcommand{\Orcv}{\mathrm{Rcv}}
\newcommand{\Ochall}{\mathrm{Chall}}

\newcommand{\Ocorrupt}{\mathrm{Corrupt}}
\newcommand{\Oexp}{\mathrm{Expose}}
\newcommand{\Oreveal}{\mathrm{Reveal}}



\iffalse
\newcommand{\full}{\!$\cdot$\,}
\newcommand{\core}{\hphantom{\!$\cdot$\,}}

\newcommand{\getscup}{\overset{\raisebox{-1pt}{\tiny$\;\cup$}}{\gets}}
\newcommand{\getsconcat}{\overset{\raisebox{-1pt}{\tiny$\;\shortparallel$}}{\gets}} % "concat assignment"

\newcommand{\bO}{\mathcal{O}}
\newcommand{\secp}{\lambda}

\fi

%DH
\newcommand{\DHgr}{\mathbb{G}}
\newcommand{\DHg}{g}
\newcommand{\DHp}{p}

\newcommand{\dlp}{\mathrm{dlp}}
\newcommand{\cdh}{\mathrm{cdh}}
\newcommand{\ddh}{\mathrm{ddh}}

%PRG and PRF
\newcommand{\PRF}{\mathrm{PRF}}
\newcommand{\PRG}{\mathrm{PRG}}

\newcommand{\PRGf}{\PRG.\mathrm{f}}
\newcommand{\PRFf}{\PRF.\mathrm{f}}

%MAC and DIGITAL SIGNATURE
\newcommand{\MAC}{\mathrm{MAC}}
\newcommand{\SIG}{\mathrm{SIG}}

\newcommand{\MACgen}{\MAC.\mathrm{gen}}
\newcommand{\MACtag}{\MAC.\mathrm{tag}}
\newcommand{\MACvfy}{\MAC.\mathrm{vfy}}

\newcommand{\SIGgen}{\SIG.\mathrm{gen}}
\newcommand{\SIGsig}{\SIG.\mathrm{sig}}
\newcommand{\SIGvfy}{\SIG.\mathrm{vfy}}

%SYMMETRIC ENCRYPTION, PUBLIC-KEY ENCRYPTION, various KEMs, and KEY EXCHANGE
\newcommand{\SYE}{\mathrm{SE}}
\newcommand{\AEAD}{\mathrm{AEAD}}
\newcommand{\PKE}{\mathrm{PKE}}
\newcommand{\KEM}{\mathrm{KEM}}
\newcommand{\IKEM}{\mathrm{IKEM}}
\newcommand{\FKEM}{\mathrm{FKEM}}
\newcommand{\UKEM}{\mathrm{UKEM}}
\newcommand{\TKE}{\mathrm{TKE}}
\newcommand{\AKE}{\mathrm{AKE}}
\newcommand{\URKE}{\mathrm{URKE}}

\newcommand{\AEADgen}{\AEAD.\mathrm{gen}}
\newcommand{\AEADenc}{\AEAD.\mathrm{enc}}
\newcommand{\AEADdec}{\AEAD.\mathrm{dec}}

\newcommand{\SYEgen}{\SYE.\mathrm{gen}}
\newcommand{\SYEenc}{\SYE.\mathrm{enc}}
\newcommand{\SYEdec}{\SYE.\mathrm{dec}}

\newcommand{\PKEgen}{\PKE.\mathrm{gen}}
\newcommand{\PKEenc}{\PKE.\mathrm{enc}}
\newcommand{\PKEdec}{\PKE.\mathrm{dec}}

\newcommand{\KEMgen}{\KEM.\mathrm{gen}}
\newcommand{\KEMenc}{\KEM.\mathrm{enc}}
\newcommand{\KEMdec}{\KEM.\mathrm{dec}}

\newcommand{\IKEMgen}{\IKEM.\mathrm{gen}}
\newcommand{\IKEMenc}{\IKEM.\mathrm{enc}}
\newcommand{\IKEMdel}{\IKEM.\mathrm{del}}
\newcommand{\IKEMdec}{\IKEM.\mathrm{dec}}

\newcommand{\UKEMgen}{\UKEM.\mathrm{gen}}
\newcommand{\UKEMenc}{\UKEM.\mathrm{enc}}
\newcommand{\UKEMdec}{\UKEM.\mathrm{dec}}

\newcommand{\FKEMgen}{\FKEM.\mathrm{gen}}
\newcommand{\FKEMenc}{\FKEM.\mathrm{enc}}
\newcommand{\FKEMdec}{\FKEM.\mathrm{dec}}

\newcommand{\TKEsnd}{\TKE.\mathrm{snd}}
\newcommand{\TKErsp}{\TKE.\mathrm{rsp}}
\newcommand{\TKErcv}{\TKE.\mathrm{rcv}}

\newcommand{\AKEgen}{\AKE.\mathrm{gen}}
\newcommand{\AKEsnd}{\AKE.\mathrm{snd}}
\newcommand{\AKErsp}{\AKE.\mathrm{rsp}}
\newcommand{\AKErcv}{\AKE.\mathrm{rcv}}

\newcommand{\URKEinit}{\URKE.\mathrm{init}}
\newcommand{\URKEsnd}{\URKE.\mathrm{snd}}
\newcommand{\URKErcv}{\URKE.\mathrm{rcv}}

%MSC
\newcommand{\advinst}{\dummyinst{adv}\node[] (tmp) at (msc@nodeadv) {$\advA$};}

%pgf-umsld

% new an instance
% Example:
% \newinst[edge distance]{var}{name:class}
\renewcommand{\newinst}[3][0.2]{
    \stepcounter{instnum}
    \path (inst\thepreinst.east)+(#1,0) node[inststyle] (inst\theinstnum)
        {\ifpgfumlsdunderline
    #3
    \else
    #3
    \fi};
    \path (inst\theinstnum)+(0,-0.5*\unitfactor) node (#2) {};
    \tikzstyle{instcolor#2}=[]
    \stepcounter{preinst}
}

\newcommand{\setumlstyle}{\tikzstyle{inststyle}=[rectangle, draw, anchor=west, minimum height=0.8cm, minimum width=1.6cm, fill=white]}

%Highlight Boxes
\tcbset{textmarker/.style={%
enhanced,
parbox=false,boxrule=0mm,boxsep=0mm,arc=0mm,
outer arc=0mm,left=6mm,right=3mm,top=7pt,bottom=7pt,
toptitle=1mm,bottomtitle=1mm,oversize}}


% define new colorboxes
\newtcolorbox{infoBox}{textmarker,
    borderline west={6pt}{0pt}{darkblue},
    colback=darkblue!10!white}
\newtcolorbox{hintBox}{textmarker,
    borderline west={6pt}{0pt}{yellow},
    colback=yellow!10!white}
\newtcolorbox{importantBox}{textmarker,
    borderline west={6pt}{0pt}{red},
    colback=red!10!white}
\newtcolorbox{noteBox}{textmarker,
    borderline west={6pt}{0pt}{green},
    colback=green!10!white}

% define commands for easy access
\newcommand{\cbnote}[2]{\begin{infoBox} \textbf{#1} #2 \end{infoBox}}
\newcommand{\cbwarning}[1]{\begin{hintBox} \textbf{Warning:} #1 \end{hintBox}}
\newcommand{\cbimportant}[1]{\begin{importantBox} \textbf{Important:} #1 \end{importantBox}}